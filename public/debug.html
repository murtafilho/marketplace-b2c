<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="debug-test">
    <title>Debug Alpine.js - Vale do Sol</title>
    <style>
        body { 
            font-family: system-ui, sans-serif; 
            padding: 2rem; 
            background: #f8f9fa; 
        }
        .debug-box { 
            background: white; 
            border-radius: 8px; 
            padding: 1.5rem; 
            margin: 1rem 0; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .status { padding: 0.5rem 1rem; border-radius: 4px; margin: 0.25rem 0; }
        .success { background: #d1edff; border-left: 4px solid #0066cc; }
        .error { background: #ffe6e6; border-left: 4px solid #cc0000; }
        .warning { background: #fff4e6; border-left: 4px solid #cc6600; }
        button { 
            background: #0066cc; 
            color: white; 
            border: none; 
            padding: 0.5rem 1rem; 
            border-radius: 4px; 
            cursor: pointer; 
            margin: 0.25rem; 
        }
        button:hover { background: #0052a3; }
        pre { background: #f5f5f5; padding: 1rem; border-radius: 4px; overflow-x: auto; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>üîç Debug Alpine.js - Vale do Sol</h1>
    
    <div class="debug-box">
        <h3>Status de Carregamento</h3>
        <div id="loading-status">
            <div class="status warning">‚è≥ Carregando Alpine.js...</div>
        </div>
    </div>
    
    <div class="debug-box">
        <h3>Teste B√°sico do Alpine</h3>
        <div x-data="{ message: 'Alpine.js carregou com sucesso!', count: 0 }">
            <p>Mensagem: <strong x-text="message"></strong></p>
            <p>Contador: <strong x-text="count"></strong></p>
            <button @click="count++">Incrementar</button>
            <button @click="message = 'Clique funcionou!'">Mudar Mensagem</button>
        </div>
    </div>
    
    <div class="debug-box">
        <h3>Teste dos Stores</h3>
        <div x-data="testStores">
            <div class="status" :class="storeStatus.cart.available ? 'success' : 'error'">
                Cart Store: <span x-text="storeStatus.cart.message"></span>
            </div>
            <div class="status" :class="storeStatus.ui.available ? 'success' : 'error'">
                UI Store: <span x-text="storeStatus.ui.message"></span>
            </div>
            <div class="status" :class="storeStatus.notifications.available ? 'success' : 'error'">
                Notifications Store: <span x-text="storeStatus.notifications.message"></span>
            </div>
            
            <template x-if="storeStatus.cart.available">
                <div style="margin-top: 1rem;">
                    <p>Items no carrinho: <strong x-text="cartCount"></strong></p>
                    <button @click="addTestItem()">Adicionar Item Teste</button>
                    <button @click="updateCounts()">Atualizar</button>
                </div>
            </template>
        </div>
    </div>
    
    <div class="debug-box">
        <h3>Logs do Console</h3>
        <p>Informa√ß√µes detalhadas est√£o no console do navegador (F12).</p>
        <button onclick="logDebugInfo()">Mostrar Logs Detalhados</button>
        <div id="console-logs"></div>
    </div>

    <!-- Carregar assets do Vite -->
    <link rel="stylesheet" href="./build/assets/app-Bo494VyC.css">
    <script type="module" src="./build/assets/app-C1xSm9Tb.js"></script>

    <script>
        // Aguardar que a DOM esteja pronta
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM carregada, aguardando Alpine...');
            
            // Function para testar stores
            window.testStores = {
                storeStatus: {
                    cart: { available: false, message: 'N√£o carregado' },
                    ui: { available: false, message: 'N√£o carregado' },
                    notifications: { available: false, message: 'N√£o carregado' }
                },
                cartCount: 0,
                
                init() {
                    console.log('üîß Inicializando teste de stores');
                    this.checkStores();
                },
                
                checkStores() {
                    setTimeout(() => {
                        try {
                            // Test Cart Store
                            if (window.Alpine && Alpine.store('cart')) {
                                this.storeStatus.cart.available = true;
                                this.storeStatus.cart.message = `Dispon√≠vel (${Alpine.store('cart').items.length} items)`;
                                this.cartCount = Alpine.store('cart').count;
                            } else {
                                this.storeStatus.cart.message = 'N√£o encontrado';
                            }
                            
                            // Test UI Store  
                            if (window.Alpine && Alpine.store('ui')) {
                                this.storeStatus.ui.available = true;
                                this.storeStatus.ui.message = 'Dispon√≠vel';
                            } else {
                                this.storeStatus.ui.message = 'N√£o encontrado';
                            }
                            
                            // Test Notifications Store
                            if (window.Alpine && Alpine.store('notifications')) {
                                this.storeStatus.notifications.available = true;
                                this.storeStatus.notifications.message = 'Dispon√≠vel';
                            } else {
                                this.storeStatus.notifications.message = 'N√£o encontrado';
                            }
                            
                        } catch (error) {
                            console.error('Erro ao testar stores:', error);
                        }
                    }, 1000);
                },
                
                addTestItem() {
                    try {
                        if (Alpine.store('cart')) {
                            Alpine.store('cart').addItem({
                                id: Date.now(),
                                name: `Produto Teste ${Date.now()}`,
                                price: Math.floor(Math.random() * 100) + 10
                            });
                            this.updateCounts();
                            console.log('‚úÖ Item adicionado ao carrinho');
                        }
                    } catch (error) {
                        console.error('Erro ao adicionar item:', error);
                    }
                },
                
                updateCounts() {
                    if (Alpine.store('cart')) {
                        this.cartCount = Alpine.store('cart').count;
                    }
                }
            };
            
            // Aguardar Alpine estar pronto
            let alpineCheckInterval = setInterval(() => {
                if (window.Alpine) {
                    console.log('‚úÖ Alpine.js carregado e dispon√≠vel');
                    clearInterval(alpineCheckInterval);
                    
                    document.getElementById('loading-status').innerHTML = 
                        '<div class="status success">‚úÖ Alpine.js carregado com sucesso!</div>';
                    
                    // Aguardar stores estarem dispon√≠veis
                    setTimeout(() => {
                        logDebugInfo();
                    }, 2000);
                }
            }, 100);
            
            // Timeout de seguran√ßa
            setTimeout(() => {
                if (!window.Alpine) {
                    console.error('‚ùå Alpine.js n√£o carregou ap√≥s 10 segundos');
                    document.getElementById('loading-status').innerHTML = 
                        '<div class="status error">‚ùå Falha ao carregar Alpine.js</div>';
                }
                clearInterval(alpineCheckInterval);
            }, 10000);
        });
        
        function logDebugInfo() {
            console.log('=== DEBUG INFO ===');
            console.log('Alpine:', window.Alpine);
            
            if (window.Alpine) {
                console.log('Cart Store:', Alpine.store('cart'));
                console.log('UI Store:', Alpine.store('ui'));
                console.log('Notifications Store:', Alpine.store('notifications'));
                
                if (Alpine.store('cart')) {
                    console.log('Cart Items:', Alpine.store('cart').items);
                    console.log('Cart Count:', Alpine.store('cart').count);
                }
            }
            
            // Log no HTML tamb√©m
            const logDiv = document.getElementById('console-logs');
            logDiv.innerHTML = '<pre>' + JSON.stringify({
                alpine_available: !!window.Alpine,
                cart_store: !!Alpine.store('cart'),
                ui_store: !!Alpine.store('ui'),
                notifications_store: !!Alpine.store('notifications'),
                timestamp: new Date().toISOString()
            }, null, 2) + '</pre>';
        }
    </script>
</body>
</html>